<div class="recipe-table-container">
  <!-- Filter Controls -->
  <div class="filter-controls">
    <div class="filter-row">
      <div class="search-control">
        <input
          pInputText
          type="text"
          [(ngModel)]="searchTerm"
          (input)="applyFilters()"
          placeholder="Search recipes..."
          class="search-input" />
        <i class="pi pi-search search-icon"></i>
      </div>

      <p-select
        [options]="typeOptions"
        [(ngModel)]="selectedType"
        (onChange)="applyFilters()"
        placeholder="All Types"
        [showClear]="true"
        class="filter-dropdown">
      </p-select>

      <p-select
        [options]="cuisineOptions"
        [(ngModel)]="selectedCuisine"
        (onChange)="applyFilters()"
        placeholder="All Cuisines"
        [showClear]="true"
        class="filter-dropdown">
      </p-select>

      <button
        pButton
        type="button"
        label="Clear Filters"
        (click)="clearAllFilters()"
        icon="pi pi-filter-slash"
        severity="secondary"
        size="small"
        class="clear-btn">
      </button>
    </div>
  </div>

  <!-- Simplified Table -->
  <p-table
    [value]="filteredRecipes"
    [scrollable]="true"
    scrollHeight="400px"
    responsiveLayout="scroll"
    sortMode="single">
    <ng-template pTemplate="header">
      <tr>
        <th class="recipe-name-col" pSortableColumn="name">
          Recipe
          <p-sortIcon field="name"></p-sortIcon>
        </th>
        <th class="last-eaten-col" pSortableColumn="lastEaten">
          Last Eaten
          <p-sortIcon field="lastEaten"></p-sortIcon>
        </th>
        <th class="ingredients-col">Ingredients</th>
        <th class="actions-col">Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-recipe>
      <tr [class.selected-recipe]="isRecipeSelected(recipe)">
        <td class="recipe-name-cell">
          <div class="recipe-info">
            <div class="recipe-name">
              @if (recipe.url && recipe.url.trim()) {
                <a [href]="recipe.url" target="_blank" rel="noopener" class="recipe-link">
                  {{recipe.name}}
                  <i class="pi pi-external-link link-icon"></i>
                </a>
              } @else {
                {{recipe.name}}
              }
            </div>
            <div class="recipe-meta">{{recipe.type}} â€¢ {{recipe.cuisine}}</div>
          </div>
        </td>
        <td class="last-eaten-cell">{{recipe.lastEaten}}</td>
        <td class="ingredients-cell">
          <button
            pButton
            type="button"
            (click)="onViewIngredients(recipe); $event.stopPropagation()"
            size="small"
            severity="secondary"
            class="action-btn view-btn"
            [text]="false">
            <i class="pi pi-eye"></i>
          </button>
        </td>
        <td class="actions-cell">
          <button
            pButton
            type="button"
            (click)="onRecipeSelect(recipe); $event.stopPropagation()"
            size="small"
            severity="success"
            class="action-btn add-btn"
            [disabled]="isRecipeSelected(recipe)">
            <i class="pi pi-plus"></i> Add
          </button>
          <button
            pButton
            type="button"
            (click)="onEditRecipe(recipe); $event.stopPropagation()"
            size="small"
            severity="info"
            class="action-btn edit-btn"
            [disabled]="isRecipeSelected(recipe)">
            <i class="pi pi-pencil"></i> Edit
          </button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
