<div class="main-container">
  <header class="main-header">
    <img ngSrc="assets/nomses.png" alt="Grocery Time" class="brand-logo" height="1024" width="1024"/>
    <div class="tab-buttons">
      <button
        pButton
        type="button"
        label="Recipes"
        (click)="switchTab('recipes')"
        [severity]="activeTab === 'recipes' ? 'primary' : 'secondary'"
        icon="pi pi-book"
        class="tab-btn">
      </button>
      <button
        pButton
        type="button"
        label="Groceries"
        (click)="switchTab('groceries')"
        [severity]="activeTab === 'groceries' ? 'primary' : 'secondary'"
        icon="pi pi-shopping-bag"
        class="tab-btn">
      </button>
      <button
        pButton
        type="button"
        (click)="switchTab('list')"
        [severity]="activeTab === 'list' ? 'primary' : 'secondary'"
        icon="pi pi-list"
        class="tab-btn list-tab-btn">
        <span class="tab-label">List</span>
        @if (selectedItems.length > 0) {
          <span class="item-count-badge">{{ selectedItems.length }}</span>
        }
      </button>
    </div>
  </header>

  <main class="main-content">
    <!-- Recipes Tab -->
    <div *ngIf="activeTab === 'recipes'" class="tab-content">
      <div class="tab-header">
        <button
          pButton
          type="button"
          label="Refresh Recipes"
          (click)="loadRecipes()"
          icon="pi pi-refresh"
          severity="info">
        </button>
      </div>
      <app-recipe-table
        [recipes]="recipes"
        [selectedRecipes]="selectedRecipes"
        (recipeSelected)="onRecipeSelected($event)"
        (editRecipe)="onEditRecipe($event)"
        (viewIngredients)="onViewIngredients($event)">
      </app-recipe-table>
    </div>

    <!-- Groceries Tab -->
    <div *ngIf="activeTab === 'groceries'" class="tab-content">
      <div class="tab-header">
        <button
          pButton
          type="button"
          label="Add Item"
          (click)="openAddModal()"
          icon="pi pi-plus"
          severity="success">
        </button>
        <button
          pButton
          type="button"
          label="Refresh"
          (click)="loadGroceries()"
          icon="pi pi-refresh"
          severity="info">
        </button>
      </div>
      <app-grocery-table
        [groceries]="groceries"
        [selectedGroceries]="selectedGroceries"
        (grocerySelected)="onGrocerySelected($event)"
        (deleteGrocery)="onDeleteGrocery($event)">
      </app-grocery-table>
    </div>

    <!-- Shopping List Tab -->
    <div *ngIf="activeTab === 'list'" class="tab-content list-tab-content">
      <app-shopping-list [selectedRecipes]="selectedItems"></app-shopping-list>
    </div>
  </main>

  <!-- Recipe Modals -->
  <app-recipe-edit-modal
    [(visible)]="showEditModal"
    [recipe]="editingRecipe"
    (recipeSaved)="onRecipeSaved($event)">
  </app-recipe-edit-modal>

  <app-ingredients-modal
    [(visible)]="showIngredientsModal"
    [recipe]="viewingRecipe">
  </app-ingredients-modal>

  <!-- Grocery Modals -->
  <app-grocery-add-modal
    [(visible)]="showAddModal"
    (itemAdded)="onItemAdded($event)">
  </app-grocery-add-modal>

  <app-grocery-delete-modal
    [(visible)]="showDeleteModal"
    [grocery]="deletingGrocery"
    (confirmDelete)="onConfirmDelete($event)">
  </app-grocery-delete-modal>
</div>
